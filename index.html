<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purple for Women's Rights</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #764ba2;
            text-align: center;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .info-section {
            background: #f8f4ff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #764ba2;
        }

        .info-section h2 {
            color: #764ba2;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .info-section p {
            color: #555;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .upload-section {
            margin-bottom: 30px;
        }

        .option-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            background: #e0e0e0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: #764ba2;
            color: white;
        }

        .tab-btn:hover {
            transform: translateY(-2px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .tiktok-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .tiktok-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .tiktok-input:focus {
            outline: none;
            border-color: #764ba2;
        }

        .fetch-btn {
            background: #764ba2;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .fetch-btn:hover {
            background: #5a3680;
            transform: translateY(-2px);
        }

        .fetch-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .upload-label {
            background: #764ba2;
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            text-align: center;
            width: 100%;
        }

        .upload-label:hover {
            background: #5a3680;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(118, 75, 162, 0.4);
        }

        #fileInput {
            display: none;
        }

        .preview-section {
            display: none;
            margin-bottom: 30px;
        }

        .canvas-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        #canvas {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .slider-container {
            margin: 20px 0;
        }

        .slider-container label {
            display: block;
            margin-bottom: 10px;
            color: #555;
            font-weight: 600;
        }

        #intensitySlider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        #intensitySlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #764ba2;
            cursor: pointer;
        }

        #intensitySlider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #764ba2;
            cursor: pointer;
            border: none;
        }

        .download-btn {
            background: #28a745;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
        }

        .download-btn:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }

        .donation-section {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #ffc107;
        }

        .donation-section h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .donation-section p {
            color: #856404;
            margin-bottom: 15px;
        }

        .donate-btn {
            background: #ffc107;
            color: #000;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s;
        }

        .donate-btn:hover {
            background: #e0a800;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 193, 7, 0.4);
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
        }

        .loading {
            text-align: center;
            color: #764ba2;
            font-weight: 600;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ’œ Purple for Women's Rights</h1>
        
        <div class="info-section">
            <h2>Why Purple?</h2>
            <p>Purple has long been associated with the women's rights movement, representing dignity, justice, and equality. By changing your profile picture to purple, you're showing solidarity with women's rights and raising awareness for gender equality worldwide.</p>
            <p>Join millions standing together for equal rights, equal opportunities, and equal respect for all women.</p>
        </div>

        <div class="upload-section">
            <div class="option-tabs">
                <button class="tab-btn active" data-tab="tiktok">TikTok Username</button>
                <button class="tab-btn" data-tab="upload">Upload Image</button>
            </div>

            <div id="tiktok-tab" class="tab-content active">
                <div class="tiktok-input-group">
                    <input type="text" id="tiktokUsername" class="tiktok-input" placeholder="Enter TikTok username (e.g., @username)">
                    <button id="fetchBtn" class="fetch-btn">Fetch</button>
                </div>
                <div class="loading" id="loading">Loading profile picture...</div>
                <div class="error-message" id="errorMessage"></div>
            </div>

            <div id="upload-tab" class="tab-content">
                <label for="fileInput" class="upload-label">Choose Image File</label>
                <input type="file" id="fileInput" accept="image/*">
            </div>
        </div>

        <div class="preview-section" id="previewSection">
            <div class="canvas-container">
                <canvas id="canvas"></canvas>
            </div>
            
            <div class="slider-container">
                <label for="intensitySlider">Purple Intensity: <span id="intensityValue">50%</span></label>
                <input type="range" id="intensitySlider" min="20" max="80" value="50">
            </div>

            <button class="download-btn" id="downloadBtn">Download Purple Picture</button>
        </div>

        <div class="donation-section">
            <h3>Support Women's Rights Organizations</h3>
            <p>Consider donating to organizations working for gender equality and women's empowerment.</p>
            <a href="https://www.unwomen.org/en/donate" target="_blank" class="donate-btn">Donate to UN Women</a>
        </div>
    </div>

    <script>
        const fileInput = document.getElementById('fileInput');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const previewSection = document.getElementById('previewSection');
        const downloadBtn = document.getElementById('downloadBtn');
        const intensitySlider = document.getElementById('intensitySlider');
        const intensityValue = document.getElementById('intensityValue');
        const tiktokUsername = document.getElementById('tiktokUsername');
        const fetchBtn = document.getElementById('fetchBtn');
        const loading = document.getElementById('loading');
        const errorMessage = document.getElementById('errorMessage');
        
        let originalImage = null;

        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(this.dataset.tab + '-tab').classList.add('active');
                
                errorMessage.style.display = 'none';
            });
        });

        // Fetch TikTok profile picture
        fetchBtn.addEventListener('click', async function() {
            let username = tiktokUsername.value.trim();
            if (!username) {
                showError('Please enter a TikTok username');
                return;
            }

            // Remove @ if user included it
            username = username.replace('@', '');

            loading.style.display = 'block';
            errorMessage.style.display = 'none';
            fetchBtn.disabled = true;

            try {
                // Using TikTok's public API endpoint
                const response = await fetch(`https://www.tiktok.com/@${username}`, {
                    method: 'GET',
                    headers: {
                        'User-Agent': 'Mozilla/5.0'
                    }
                });

                if (!response.ok) {
                    throw new Error('User not found');
                }

                const html = await response.text();
                
                // Extract profile picture URL from HTML
                const match = html.match(/"avatarLarger":"([^"]+)"/);
                
                if (!match) {
                    throw new Error('Could not find profile picture');
                }

                const avatarUrl = match[1].replace(/\\u002F/g, '/');
                
                // Load the image
                const img = new Image();
                img.crossOrigin = 'anonymous';
                img.onload = function() {
                    originalImage = img;
                    applyPurpleOverlay();
                    previewSection.style.display = 'block';
                    loading.style.display = 'none';
                    fetchBtn.disabled = false;
                };
                img.onerror = function() {
                    showError('Could not load profile picture. Try uploading an image instead.');
                    loading.style.display = 'none';
                    fetchBtn.disabled = false;
                };
                
                // Use a CORS proxy to load the image
                img.src = `https://cors-anywhere.herokuapp.com/${avatarUrl}`;
                
            } catch (error) {
                showError('Could not fetch TikTok profile picture. Please try uploading an image instead.');
                loading.style.display = 'none';
                fetchBtn.disabled = false;
            }
        });

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
        }

        // File upload
        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = new Image();
                    img.onload = function() {
                        originalImage = img;
                        applyPurpleOverlay();
                        previewSection.style.display = 'block';
                    };
                    img.src = event.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        intensitySlider.addEventListener('input', function() {
            intensityValue.textContent = this.value + '%';
            if (originalImage) {
                applyPurpleOverlay();
            }
        });

        function applyPurpleOverlay() {
            const maxSize = 800;
            let width = originalImage.width;
            let height = originalImage.height;

            if (width > maxSize || height > maxSize) {
                if (width > height) {
                    height = (height / width) * maxSize;
                    width = maxSize;
                } else {
                    width = (width / height) * maxSize;
                    height = maxSize;
                }
            }

            canvas.width = width;
            canvas.height = height;

            ctx.drawImage(originalImage, 0, 0, width, height);

            const intensity = intensitySlider.value / 100;
            ctx.globalCompositeOperation = 'multiply';
            ctx.fillStyle = `rgba(118, 75, 162, ${intensity})`;
            ctx.fillRect(0, 0, width, height);

            ctx.globalCompositeOperation = 'lighten';
            ctx.fillStyle = `rgba(118, 75, 162, ${intensity * 0.3})`;
            ctx.fillRect(0, 0, width, height);

            ctx.globalCompositeOperation = 'source-over';
        }

        downloadBtn.addEventListener('click', function() {
            const link = document.createElement('a');
            link.download = 'purple-profile-picture.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        });
    </script>
</body>
</html>